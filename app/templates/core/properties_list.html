<!-- 物件一覧テーブル -->
{% extends "base.html" %}
{% block title %}物件{% endblock %}
{% block content %}
  <h1 class="title">物件一覧</h1>
  <!-- 同じページ内で新規作成/編集フォームを表示 -->
  {% include "core/property_form.html" %}
  <table class="table is-fullwidth is-striped">
    <thead>
      <tr>
        <th>物件名</th>
        <th>住所</th>
        <th>備考</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      {% for property in properties %}
        <!-- 編集対象の行は背景色で強調 -->
        <tr {% if editing_property and property.id == editing_property.id %}class="has-background-warning-light"{% endif %}>
          <td>{{ property.name }}</td>
          <td>{{ property.address }}</td>
          <td>{{ property.note or "-" }}</td>
          <td>
            <div class="buttons are-small">
              {% if editing_property and property.id == editing_property.id %}
                <span class="button is-static is-light">編集中</span>
              {% else %}
                <a
                  class="button is-info is-light"
                  href="{{ url_for('core.properties', property_id=property.id) }}"
                >編集</a>
              {% endif %}
              <form method="post">
                <!-- 削除は各行の CSRF 対応フォームで処理 -->
                {{ delete_forms[property.id].hidden_tag() }}
                {{ delete_forms[property.id].submit(class="button is-danger is-light") }}
              </form>
            </div>
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="4">物件がまだ登録されていません。</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
